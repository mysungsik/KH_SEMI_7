<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
<comment>커뮤니티 xml파일</comment>

	<entry key="selectBoardList">
		SELECT P.TYPE_NAME, C.COMM_TITLE, U.USER_NAME, C.CREATE_DT, C.COMM_VIEWS, T.TEAM_NAME, C.COMM_NO
		FROM COMM C
		LEFT JOIN TEAMS T ON T.TEAM_NO = C.TEAM_NO
		JOIN USER_INFO U USING(USER_NO)
		JOIN COMM_TYPE P ON TYPE_NO = COMM_TYPE
		WHERE COMM_TYPE = ?
		AND COMM_ST = 'N'
		ORDER BY COMM_NO DESC
	</entry>
	
	
	<entry key="selectBoardListAll">
		SELECT P.TYPE_NAME, C.COMM_TITLE, U.USER_NAME, C.CREATE_DT, C.COMM_VIEWS, T.TEAM_NAME, C.COMM_NO, C.COMM_TYPE
		FROM COMM C
		LEFT JOIN TEAMS T ON T.TEAM_NO = C.TEAM_NO
		JOIN USER_INFO U USING(USER_NO)
		JOIN COMM_TYPE P ON TYPE_NO = COMM_TYPE
		WHERE COMM_ST = 'N'
		ORDER BY COMM_NO DESC
	</entry>
	
	<!-- 팀 이름 가져오기 -->
	<entry key="selectTeams">
		SELECT TEAM_NO, TEAM_NAME FROM TEAMS
	</entry>
	
	<!-- 팀별 게시판 가져오기 -->
	<entry key="selectTeamBoardList">
		SELECT P.TYPE_NAME, C.COMM_TITLE, U.USER_NAME, C.CREATE_DT, C.COMM_VIEWS, T.TEAM_NAME, C.COMM_NO
		FROM COMM C
		LEFT JOIN TEAMS T ON T.TEAM_NO = C.TEAM_NO
		JOIN USER_INFO U USING(USER_NO)
		JOIN COMM_TYPE P ON TYPE_NO = COMM_TYPE
		WHERE C.TEAM_NO = ?
		ORDER BY COMM_NO DESC
	</entry>
	
	<!-- 게시글 상세 -->
	<entry key="selectBoardDetail">
		SELECT C.COMM_CONTENT, C.COMM_TITLE, U.USER_NAME, C.CREATE_DT, C.COMM_VIEWS, TYPE_NAME, TEAM_NAME
		FROM COMM C
		LEFT JOIN TEAMS T ON T.TEAM_NO = C.TEAM_NO
		JOIN USER_INFO U USING(USER_NO)
		JOIN COMM_TYPE T ON TYPE_NO = COMM_TYPE
		WHERE COMM_NO = ?
	</entry>
	
	<!-- 댓글 -->
	<entry key="selectReplyList">
		SELECT USER_NAME, REPLY_CONTENT, REPLY_DT
		FROM REPLY
		JOIN USER_INFO USING(USER_NO)
		WHERE REPLY_TARGET_NO = ?
	</entry>
	
		<!-- 게시글 등록 -->
	<entry key="insertBoard">
		INSERT INTO COMM 
		VALUES(SEQ_COMM_NO.NEXTVAL, ?, ?, ?, ?, ?, DEFAULT, DEFAULT, DEFAULT, DEFAULT)
	</entry>
	
	<!-- 최근 게시글 번호 조회 -->
	<entry key="selectCurrentNo">
		SELECT COMM_NO FROM
		(SELECT * FROM COMM ORDER BY COMM_NO DESC)
		WHERE ROWNUM = 1
	</entry>
	
	<!-- 게시글 이미지 삽입 -->
	<entry key="insertImage">
		INSERT INTO COMM_IMG
		VALUES(?, ?, ?, 0)
	</entry>
	
		<!-- 게시글 이미지 조회 -->
	<entry key="selectBoardImage">
		SELECT IMG_RENAME FROM COMM_IMG 
		WHERE COMM_NO = ?
	</entry>
	
	<!-- 메인 페이지 조회(공지, 자유, 응원) -->
	<entry key="selectMainPage">
	<![CDATA[
		SELECT p.TYPE_NAME, c.COMM_TITLE, c.COMM_CONTENT, u.USER_NAME, c.COMM_VIEWS, c.CREATE_DT, t.TEAM_NAME, c.COMM_NO
		FROM (
		    SELECT COMM.*, ROW_NUMBER() OVER (ORDER BY COMM_NO DESC) AS RN
		    FROM COMM
		    WHERE COMM_TYPE = ?
		    AND COMM_ST = 'N'
		) c
		JOIN USER_INFO u ON c.USER_NO = u.USER_NO
		JOIN COMM_TYPE p ON c.COMM_TYPE = p.TYPE_NO
		LEFT JOIN TEAMS t ON c.TEAM_NO = t.TEAM_NO
		WHERE c.RN <= 5
	 ]]>
	</entry>
	
		<!-- 메인 페이지 조회(전체) -->
	<entry key="selectMainPageAll">
	<![CDATA[
		SELECT p.TYPE_NAME, c.COMM_TITLE, c.COMM_CONTENT, u.USER_NAME, c.COMM_VIEWS, c.CREATE_DT, t.TEAM_NAME, c.COMM_NO, p.TYPE_NO
		FROM (
		    SELECT COMM.*, ROW_NUMBER() OVER (ORDER BY COMM_NO DESC) AS RN
		    FROM COMM
		    WHERE COMM_ST = 'N'
		) c
		JOIN USER_INFO u ON c.USER_NO = u.USER_NO
		JOIN COMM_TYPE p ON c.COMM_TYPE = p.TYPE_NO
		LEFT JOIN TEAMS t ON c.TEAM_NO = t.TEAM_NO
		WHERE c.RN <= 5
	 ]]>
	</entry>
	
	<!-- 게시글 삭제 -->
	<entry key="deleteBoard">
		UPDATE COMM SET COMM_ST = 'Y' WHERE COMM_NO = ?
	</entry>
</properties>
